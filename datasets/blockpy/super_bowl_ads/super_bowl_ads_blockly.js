

var super_bowl_ads_INDEXES = [
    ["(None)", "(None)"],
    
    ["Data.Viewership.Views", "Data.Viewership.Views"] 
];

var super_bowl_ads_INDEX_VALUES = {
    "(None)": [],
    
    "Data.Viewership.Views": [
        
        ["10", "10"] ,
        ["21", "21"] ,
        ["42", "42"] ,
        ["56", "56"] ,
        ["79", "79"] ,
        ["92", "92"] ,
        ["111", "111"] ,
        ["125", "125"] ,
        ["136", "136"] ,
        ["162", "162"] ,
        ["179", "179"] ,
        ["186", "186"] ,
        ["198", "198"] ,
        ["236", "236"] ,
        ["293", "293"] ,
        ["301", "301"] ,
        ["319", "319"] ,
        ["350", "350"] ,
        ["394", "394"] ,
        ["518", "518"] ,
        ["561", "561"] ,
        ["782", "782"] ,
        ["788", "788"] ,
        ["907", "907"] ,
        ["987", "987"] ,
        ["998", "998"] ,
        ["1171", "1171"] ,
        ["1190", "1190"] ,
        ["1264", "1264"] ,
        ["1294", "1294"] ,
        ["1361", "1361"] ,
        ["1475", "1475"] ,
        ["1874", "1874"] ,
        ["2732", "2732"] ,
        ["2801", "2801"] ,
        ["2985", "2985"] ,
        ["3183", "3183"] ,
        ["3548", "3548"] ,
        ["3667", "3667"] ,
        ["3739", "3739"] ,
        ["3754", "3754"] ,
        ["3805", "3805"] ,
        ["3900", "3900"] ,
        ["4302", "4302"] ,
        ["4641", "4641"] ,
        ["4873", "4873"] ,
        ["5049", "5049"] ,
        ["5264", "5264"] ,
        ["5699", "5699"] ,
        ["6430", "6430"] ,
        ["6513", "6513"] ,
        ["6641", "6641"] ,
        ["6713", "6713"] ,
        ["7253", "7253"] ,
        ["7621", "7621"] ,
        ["8990", "8990"] ,
        ["9036", "9036"] ,
        ["9335", "9335"] ,
        ["9649", "9649"] ,
        ["10338", "10338"] ,
        ["10925", "10925"] ,
        ["10929", "10929"] ,
        ["11074", "11074"] ,
        ["11311", "11311"] ,
        ["11608", "11608"] ,
        ["12106", "12106"] ,
        ["13245", "13245"] ,
        ["13312", "13312"] ,
        ["13741", "13741"] ,
        ["14267", "14267"] ,
        ["14395", "14395"] ,
        ["14579", "14579"] ,
        ["15776", "15776"] ,
        ["16083", "16083"] ,
        ["16399", "16399"] ,
        ["16997", "16997"] ,
        ["17209", "17209"] ,
        ["17892", "17892"] ,
        ["18670", "18670"] ,
        ["20130", "20130"] ,
        ["21314", "21314"] ,
        ["21813", "21813"] ,
        ["23327", "23327"] ,
        ["23636", "23636"] ,
        ["24595", "24595"] ,
        ["25834", "25834"] ,
        ["27378", "27378"] ,
        ["28847", "28847"] ,
        ["29219", "29219"] ,
        ["30123", "30123"] ,
        ["32091", "32091"] ,
        ["32557", "32557"] ,
        ["33766", "33766"] ,
        ["34440", "34440"] ,
        ["34565", "34565"] ,
        ["36683", "36683"] ,
        ["36832", "36832"] ,
        ["38385", "38385"] ,
        ["38574", "38574"] ,
        ["38968", "38968"] ,
        ["39730", "39730"] ,
        ["39897", "39897"] ,
        ["40818", "40818"] ,
        ["41379", "41379"] ,
        ["41441", "41441"] ,
        ["41828", "41828"] ,
        ["43983", "43983"] ,
        ["45799", "45799"] ,
        ["47752", "47752"] ,
        ["48035", "48035"] ,
        ["48617", "48617"] ,
        ["49339", "49339"] ,
        ["50088", "50088"] ,
        ["50850", "50850"] ,
        ["54079", "54079"] ,
        ["55676", "55676"] ,
        ["56257", "56257"] ,
        ["60774", "60774"] ,
        ["62538", "62538"] ,
        ["63129", "63129"] ,
        ["65162", "65162"] ,
        ["67182", "67182"] ,
        ["67452", "67452"] ,
        ["68458", "68458"] ,
        ["69050", "69050"] ,
        ["69440", "69440"] ,
        ["72997", "72997"] ,
        ["77142", "77142"] ,
        ["77720", "77720"] ,
        ["81183", "81183"] ,
        ["81952", "81952"] ,
        ["85274", "85274"] ,
        ["85454", "85454"] ,
        ["86928", "86928"] ,
        ["87396", "87396"] ,
        ["87687", "87687"] ,
        ["88445", "88445"] ,
        ["88458", "88458"] ,
        ["91378", "91378"] ,
        ["92878", "92878"] ,
        ["95355", "95355"] ,
        ["97247", "97247"] ,
        ["103433", "103433"] ,
        ["110004", "110004"] ,
        ["111442", "111442"] ,
        ["112297", "112297"] ,
        ["113771", "113771"] ,
        ["116294", "116294"] ,
        ["120196", "120196"] ,
        ["121400", "121400"] ,
        ["122388", "122388"] ,
        ["128792", "128792"] ,
        ["129399", "129399"] ,
        ["132054", "132054"] ,
        ["134186", "134186"] ,
        ["142310", "142310"] ,
        ["147160", "147160"] ,
        ["156718", "156718"] ,
        ["166102", "166102"] ,
        ["175482", "175482"] ,
        ["176547", "176547"] ,
        ["177285", "177285"] ,
        ["177497", "177497"] ,
        ["179695", "179695"] ,
        ["184689", "184689"] ,
        ["204026", "204026"] ,
        ["218329", "218329"] ,
        ["219464", "219464"] ,
        ["220292", "220292"] ,
        ["232124", "232124"] ,
        ["236941", "236941"] ,
        ["246619", "246619"] ,
        ["249186", "249186"] ,
        ["286010", "286010"] ,
        ["292010", "292010"] ,
        ["302143", "302143"] ,
        ["304254", "304254"] ,
        ["310443", "310443"] ,
        ["327529", "327529"] ,
        ["353513", "353513"] ,
        ["358142", "358142"] ,
        ["373684", "373684"] ,
        ["385777", "385777"] ,
        ["403641", "403641"] ,
        ["491630", "491630"] ,
        ["503550", "503550"] ,
        ["555734", "555734"] ,
        ["576696", "576696"] ,
        ["582575", "582575"] ,
        ["598260", "598260"] ,
        ["640393", "640393"] ,
        ["669906", "669906"] ,
        ["729583", "729583"] ,
        ["746836", "746836"] ,
        ["865781", "865781"] ,
        ["955616", "955616"] ,
        ["1046640", "1046640"] ,
        ["1060001", "1060001"] ,
        ["1214968", "1214968"] ,
        ["1274288", "1274288"] ,
        ["1452877", "1452877"] ,
        ["1683994", "1683994"] ,
        ["1939823", "1939823"] ,
        ["1990447", "1990447"] ,
        ["2319854", "2319854"] ,
        ["3464175", "3464175"] ,
        ["3624622", "3624622"] ,
        ["4921309", "4921309"] ,
        ["6428474", "6428474"] ,
        ["7658201", "7658201"] ,
        ["7952240", "7952240"] ,
        ["22849816", "22849816"] ,
        ["26727063", "26727063"] ,
        ["28785122", "28785122"] ,
        ["176373378", "176373378"] 
    ]
}

var super_bowl_ads_PROPERTIES = [
    ["Year", "Year"] ,
    ["Brand", "Brand"] ,
    ["Data.Content.Funny", "Data.Content.Funny"] ,
    ["Data.Content.Shows Product", "Data.Content.Shows Product"] ,
    ["Data.Content.Patriotic", "Data.Content.Patriotic"] ,
    ["Data.Content.Celebrity", "Data.Content.Celebrity"] ,
    ["Data.Content.Danger", "Data.Content.Danger"] ,
    ["Data.Content.Animals", "Data.Content.Animals"] ,
    ["Data.Content.Sexual", "Data.Content.Sexual"] ,
    ["Data.Viewership.Views", "Data.Viewership.Views"] ,
    ["Data.Viewership.Likes", "Data.Viewership.Likes"] ,
    ["Data.Viewership.Dislikes", "Data.Viewership.Dislikes"] ,
    ["Data.Title", "Data.Title"] 
]

Blockly.Blocks['super_bowl_ads_get'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput('MAIN')
        .appendField("super_bowl_ads.get")
        .appendField(new Blockly.FieldDropdown(super_bowl_ads_PROPERTIES), "PROPERTY");
    this.appendDummyInput('SECOND')
        .appendField("filter")
        .appendField(new Blockly.FieldDropdown(super_bowl_ads_INDEXES, function(option) {
                        this.getSourceBlock().updateShape_(option);
                    }), "INDEX")
    this.updateShape_("(None)");
    this.setInputsInline(false);
    this.setOutput(true, "Array");
    this.setTooltip('Returns a list of super bowl ads data.');
  },
  mutationToDom: function() {
    var container = document.createElement('mutation');
    container.setAttribute('index', this.getFieldValue('INDEX'));
    container.setAttribute('index_value', this.getFieldValue('INDEX_VALUE'));
    container.setAttribute('module', "super_bowl_ads")
    return container;
  },
  domToMutation: function(xmlElement) {
    var index = xmlElement.getAttribute('index');
    this.setFieldValue(index, 'INDEX');
    var index_value = xmlElement.getAttribute('index_value');
    this.updateShape_(index, index_value);
  },
  updateShape_: function(index, index_value) {
    var inputGroup = this.getInput('SECOND')
    var fieldExists = this.getField('INDEX_VALUE');
    if (fieldExists) {
        inputGroup.removeField('INDEX_VALUE');
    }
    try {
        if (index != undefined && index != '(None)') {
            inputGroup.appendField(new Blockly.FieldDropdown(super_bowl_ads_INDEX_VALUES[index]), 'INDEX_VALUE')
            if (index_value != undefined) {
                this.setFieldValue(index_value, 'INDEX_VALUE');
            } else {
                this.setFieldValue(super_bowl_ads_INDEX_VALUES[index][0][0], 'INDEX_VALUE');
            }
        }
    } catch (e) {
        inputGroup.appendField(new Blockly.FieldLabel("Reset to fix the blocks"));
        console.error(e);
    }
  }
};
Blockly.Python['super_bowl_ads_get'] = function(block) {
    Blockly.Python.definitions_['import_super_bowl_ads'] = 'import super_bowl_ads';
    var propertyValue = block.getFieldValue('PROPERTY') || '';
    var property = Blockly.Python.quote_(propertyValue);
    var index_unquoted = block.getFieldValue('INDEX');
    var index = Blockly.Python.quote_(index_unquoted || '');
    var index_value = "''";
    if (index_unquoted !== '(None)') {
        var iv = block.getFieldValue('INDEX_VALUE') || "";
        index_value = Blockly.Python.quote_(iv);
    }
    var code = 'super_bowl_ads.get('+property+',' +index+','+index_value+')';
    return [code, Blockly.Python.ORDER_ATOMIC];
};

BlockMirrorTextToBlocks.prototype.MODULE_FUNCTION_SIGNATURES['super_bowl_ads'] = {
    "get": {
        custom: function(node, parent) {
            if (!node.args || node.args.length < 3 ||
                !node.args[0] || !node.args[1] || !node.args[2] ||
                node.args[0]._astname !== "Str" || node.args[1]._astname !== "Str" || node.args[2]._astname !== "Str"
            ) {
                throw new Error("Not the right function call.");
            }
            return BlockMirrorTextToBlocks.create_block("super_bowl_ads_get", null,
                {"PROPERTY": node.args[0].s.v},
                {}, {}, {"@INDEX": node.args[1].s.v,
                    "@INDEX_VALUE": node.args[2].s.v});
        }
    },
};

BlockMirrorBlockEditor.EXTRA_TOOLS['Data - super bowl ads'] = '<category name="Data - Super Bowl Ads" colour="45">'+
                    '<block type="super_bowl_ads_get"><mutation index="(None)" index_value=""></mutation></block>'+
                '</category>';