

var ufo_sightings_INDEXES = [
    ["(None)", "(None)"],
    
    ["Data.Encounter duration", "Data.Encounter duration"] 
];

var ufo_sightings_INDEX_VALUES = {
    "(None)": [],
    
    "Data.Encounter duration": [
        
        ["0.01", "0.01"] ,
        ["0.02", "0.02"] ,
        ["0.05", "0.05"] ,
        ["0.08", "0.08"] ,
        ["0.1", "0.1"] ,
        ["0.2", "0.2"] ,
        ["0.3", "0.3"] ,
        ["0.33", "0.33"] ,
        ["0.4", "0.4"] ,
        ["0.45", "0.45"] ,
        ["0.5", "0.5"] ,
        ["0.57", "0.57"] ,
        ["0.7", "0.7"] ,
        ["0.75", "0.75"] ,
        ["1.0", "1.0"] ,
        ["1.2", "1.2"] ,
        ["1.3", "1.3"] ,
        ["1.5", "1.5"] ,
        ["1.6", "1.6"] ,
        ["1.75", "1.75"] ,
        ["2.0", "2.0"] ,
        ["2.5", "2.5"] ,
        ["3.0", "3.0"] ,
        ["3.4", "3.4"] ,
        ["3.5", "3.5"] ,
        ["3.8", "3.8"] ,
        ["4.0", "4.0"] ,
        ["4.5", "4.5"] ,
        ["5.0", "5.0"] ,
        ["5.5", "5.5"] ,
        ["6.0", "6.0"] ,
        ["6.5", "6.5"] ,
        ["7.0", "7.0"] ,
        ["8.0", "8.0"] ,
        ["9.0", "9.0"] ,
        ["10.0", "10.0"] ,
        ["11.0", "11.0"] ,
        ["12.0", "12.0"] ,
        ["13.0", "13.0"] ,
        ["14.0", "14.0"] ,
        ["15.0", "15.0"] ,
        ["16.0", "16.0"] ,
        ["17.0", "17.0"] ,
        ["18.0", "18.0"] ,
        ["19.0", "19.0"] ,
        ["20.0", "20.0"] ,
        ["21.0", "21.0"] ,
        ["22.0", "22.0"] ,
        ["23.0", "23.0"] ,
        ["24.0", "24.0"] ,
        ["25.0", "25.0"] ,
        ["26.0", "26.0"] ,
        ["27.0", "27.0"] ,
        ["28.0", "28.0"] ,
        ["29.0", "29.0"] ,
        ["30.0", "30.0"] ,
        ["31.0", "31.0"] ,
        ["33.0", "33.0"] ,
        ["34.0", "34.0"] ,
        ["35.0", "35.0"] ,
        ["36.0", "36.0"] ,
        ["37.0", "37.0"] ,
        ["38.0", "38.0"] ,
        ["39.0", "39.0"] ,
        ["40.0", "40.0"] ,
        ["42.0", "42.0"] ,
        ["43.0", "43.0"] ,
        ["44.0", "44.0"] ,
        ["45.0", "45.0"] ,
        ["47.0", "47.0"] ,
        ["48.0", "48.0"] ,
        ["50.0", "50.0"] ,
        ["50.5", "50.5"] ,
        ["52.0", "52.0"] ,
        ["53.0", "53.0"] ,
        ["55.0", "55.0"] ,
        ["56.0", "56.0"] ,
        ["58.0", "58.0"] ,
        ["59.0", "59.0"] ,
        ["60.0", "60.0"] ,
        ["60.1", "60.1"] ,
        ["60.14", "60.14"] ,
        ["60.15", "60.15"] ,
        ["60.2", "60.2"] ,
        ["60.3", "60.3"] ,
        ["60.4", "60.4"] ,
        ["60.5", "60.5"] ,
        ["60.6", "60.6"] ,
        ["61.0", "61.0"] ,
        ["65.0", "65.0"] ,
        ["67.0", "67.0"] ,
        ["68.0", "68.0"] ,
        ["70.0", "70.0"] ,
        ["72.0", "72.0"] ,
        ["73.0", "73.0"] ,
        ["74.0", "74.0"] ,
        ["75.0", "75.0"] ,
        ["78.0", "78.0"] ,
        ["80.0", "80.0"] ,
        ["85.0", "85.0"] ,
        ["87.0", "87.0"] ,
        ["89.0", "89.0"] ,
        ["90.0", "90.0"] ,
        ["95.0", "95.0"] ,
        ["96.0", "96.0"] ,
        ["100.0", "100.0"] ,
        ["101.0", "101.0"] ,
        ["103.0", "103.0"] ,
        ["105.0", "105.0"] ,
        ["108.0", "108.0"] ,
        ["110.0", "110.0"] ,
        ["114.0", "114.0"] ,
        ["120.0", "120.0"] ,
        ["120.1", "120.1"] ,
        ["120.3", "120.3"] ,
        ["121.0", "121.0"] ,
        ["125.0", "125.0"] ,
        ["130.0", "130.0"] ,
        ["135.0", "135.0"] ,
        ["138.0", "138.0"] ,
        ["140.0", "140.0"] ,
        ["145.0", "145.0"] ,
        ["147.0", "147.0"] ,
        ["150.0", "150.0"] ,
        ["152.0", "152.0"] ,
        ["155.0", "155.0"] ,
        ["165.0", "165.0"] ,
        ["170.0", "170.0"] ,
        ["173.0", "173.0"] ,
        ["180.0", "180.0"] ,
        ["180.39", "180.39"] ,
        ["181.0", "181.0"] ,
        ["188.0", "188.0"] ,
        ["191.0", "191.0"] ,
        ["195.0", "195.0"] ,
        ["199.0", "199.0"] ,
        ["200.0", "200.0"] ,
        ["205.0", "205.0"] ,
        ["209.0", "209.0"] ,
        ["210.0", "210.0"] ,
        ["212.0", "212.0"] ,
        ["216.0", "216.0"] ,
        ["235.0", "235.0"] ,
        ["240.0", "240.0"] ,
        ["250.0", "250.0"] ,
        ["255.0", "255.0"] ,
        ["258.0", "258.0"] ,
        ["259.0", "259.0"] ,
        ["265.0", "265.0"] ,
        ["270.0", "270.0"] ,
        ["273.0", "273.0"] ,
        ["275.0", "275.0"] ,
        ["278.0", "278.0"] ,
        ["282.0", "282.0"] ,
        ["299.0", "299.0"] ,
        ["300.0", "300.0"] ,
        ["300.13", "300.13"] ,
        ["309.0", "309.0"] ,
        ["310.0", "310.0"] ,
        ["315.0", "315.0"] ,
        ["322.0", "322.0"] ,
        ["330.0", "330.0"] ,
        ["335.0", "335.0"] ,
        ["345.0", "345.0"] ,
        ["345.5", "345.5"] ,
        ["350.0", "350.0"] ,
        ["355.0", "355.0"] ,
        ["360.0", "360.0"] ,
        ["380.0", "380.0"] ,
        ["382.0", "382.0"] ,
        ["384.0", "384.0"] ,
        ["393.0", "393.0"] ,
        ["399.0", "399.0"] ,
        ["400.0", "400.0"] ,
        ["420.0", "420.0"] ,
        ["424.0", "424.0"] ,
        ["425.0", "425.0"] ,
        ["435.0", "435.0"] ,
        ["438.0", "438.0"] ,
        ["450.0", "450.0"] ,
        ["479.0", "479.0"] ,
        ["480.0", "480.0"] ,
        ["492.0", "492.0"] ,
        ["496.0", "496.0"] ,
        ["540.0", "540.0"] ,
        ["550.0", "550.0"] ,
        ["555.0", "555.0"] ,
        ["585.0", "585.0"] ,
        ["597.0", "597.0"] ,
        ["599.0", "599.0"] ,
        ["600.0", "600.0"] ,
        ["603.0", "603.0"] ,
        ["605.0", "605.0"] ,
        ["606.0", "606.0"] ,
        ["610.0", "610.0"] ,
        ["615.0", "615.0"] ,
        ["620.0", "620.0"] ,
        ["625.0", "625.0"] ,
        ["630.0", "630.0"] ,
        ["633.0", "633.0"] ,
        ["639.0", "639.0"] ,
        ["640.0", "640.0"] ,
        ["658.0", "658.0"] ,
        ["660.0", "660.0"] ,
        ["669.0", "669.0"] ,
        ["688.0", "688.0"] ,
        ["695.0", "695.0"] ,
        ["698.0", "698.0"] ,
        ["705.0", "705.0"] ,
        ["720.0", "720.0"] ,
        ["721.0", "721.0"] ,
        ["725.0", "725.0"] ,
        ["727.0", "727.0"] ,
        ["750.0", "750.0"] ,
        ["751.0", "751.0"] ,
        ["771.0", "771.0"] ,
        ["780.0", "780.0"] ,
        ["800.0", "800.0"] ,
        ["810.0", "810.0"] ,
        ["835.0", "835.0"] ,
        ["840.0", "840.0"] ,
        ["841.0", "841.0"] ,
        ["900.0", "900.0"] ,
        ["930.0", "930.0"] ,
        ["960.0", "960.0"] ,
        ["965.0", "965.0"] ,
        ["978.0", "978.0"] ,
        ["988.0", "988.0"] ,
        ["994.0", "994.0"] ,
        ["1000.0", "1000.0"] ,
        ["1015.0", "1015.0"] ,
        ["1020.0", "1020.0"] ,
        ["1045.0", "1045.0"] ,
        ["1046.0", "1046.0"] ,
        ["1049.0", "1049.0"] ,
        ["1050.0", "1050.0"] ,
        ["1060.0", "1060.0"] ,
        ["1076.0", "1076.0"] ,
        ["1080.0", "1080.0"] ,
        ["1081.0", "1081.0"] ,
        ["1084.0", "1084.0"] ,
        ["1085.0", "1085.0"] ,
        ["1090.0", "1090.0"] ,
        ["1102.0", "1102.0"] ,
        ["1110.0", "1110.0"] ,
        ["1125.0", "1125.0"] ,
        ["1133.0", "1133.0"] ,
        ["1140.0", "1140.0"] ,
        ["1155.0", "1155.0"] ,
        ["1170.0", "1170.0"] ,
        ["1180.0", "1180.0"] ,
        ["1183.0", "1183.0"] ,
        ["1184.0", "1184.0"] ,
        ["1185.0", "1185.0"] ,
        ["1194.0", "1194.0"] ,
        ["1200.0", "1200.0"] ,
        ["1203.0", "1203.0"] ,
        ["1215.0", "1215.0"] ,
        ["1217.0", "1217.0"] ,
        ["1219.0", "1219.0"] ,
        ["1224.0", "1224.0"] ,
        ["1233.0", "1233.0"] ,
        ["1236.0", "1236.0"] ,
        ["1244.0", "1244.0"] ,
        ["1245.0", "1245.0"] ,
        ["1248.0", "1248.0"] ,
        ["1250.0", "1250.0"] ,
        ["1260.0", "1260.0"] ,
        ["1263.0", "1263.0"] ,
        ["1265.0", "1265.0"] ,
        ["1266.0", "1266.0"] ,
        ["1269.0", "1269.0"] ,
        ["1270.0", "1270.0"] ,
        ["1273.0", "1273.0"] ,
        ["1275.0", "1275.0"] ,
        ["1281.0", "1281.0"] ,
        ["1289.0", "1289.0"] ,
        ["1290.0", "1290.0"] ,
        ["1293.0", "1293.0"] ,
        ["1300.0", "1300.0"] ,
        ["1305.0", "1305.0"] ,
        ["1309.0", "1309.0"] ,
        ["1310.0", "1310.0"] ,
        ["1320.0", "1320.0"] ,
        ["1325.0", "1325.0"] ,
        ["1330.0", "1330.0"] ,
        ["1335.0", "1335.0"] ,
        ["1340.0", "1340.0"] ,
        ["1341.0", "1341.0"] ,
        ["1342.0", "1342.0"] ,
        ["1345.0", "1345.0"] ,
        ["1350.0", "1350.0"] ,
        ["1351.0", "1351.0"] ,
        ["1360.0", "1360.0"] ,
        ["1365.0", "1365.0"] ,
        ["1380.0", "1380.0"] ,
        ["1391.0", "1391.0"] ,
        ["1395.0", "1395.0"] ,
        ["1396.0", "1396.0"] ,
        ["1398.0", "1398.0"] ,
        ["1400.0", "1400.0"] ,
        ["1401.0", "1401.0"] ,
        ["1408.0", "1408.0"] ,
        ["1410.0", "1410.0"] ,
        ["1420.0", "1420.0"] ,
        ["1425.0", "1425.0"] ,
        ["1438.0", "1438.0"] ,
        ["1440.0", "1440.0"] ,
        ["1500.0", "1500.0"] ,
        ["1560.0", "1560.0"] ,
        ["1620.0", "1620.0"] ,
        ["1680.0", "1680.0"] ,
        ["1705.0", "1705.0"] ,
        ["1740.0", "1740.0"] ,
        ["1800.0", "1800.0"] ,
        ["1810.0", "1810.0"] ,
        ["1830.0", "1830.0"] ,
        ["1845.0", "1845.0"] ,
        ["1860.0", "1860.0"] ,
        ["1920.0", "1920.0"] ,
        ["1935.0", "1935.0"] ,
        ["1980.0", "1980.0"] ,
        ["2040.0", "2040.0"] ,
        ["2100.0", "2100.0"] ,
        ["2160.0", "2160.0"] ,
        ["2187.0", "2187.0"] ,
        ["2220.0", "2220.0"] ,
        ["2280.0", "2280.0"] ,
        ["2340.0", "2340.0"] ,
        ["2400.0", "2400.0"] ,
        ["2496.0", "2496.0"] ,
        ["2520.0", "2520.0"] ,
        ["2530.0", "2530.0"] ,
        ["2580.0", "2580.0"] ,
        ["2640.0", "2640.0"] ,
        ["2700.0", "2700.0"] ,
        ["2760.0", "2760.0"] ,
        ["2820.0", "2820.0"] ,
        ["2880.0", "2880.0"] ,
        ["2940.0", "2940.0"] ,
        ["3000.0", "3000.0"] ,
        ["3045.0", "3045.0"] ,
        ["3060.0", "3060.0"] ,
        ["3120.0", "3120.0"] ,
        ["3180.0", "3180.0"] ,
        ["3240.0", "3240.0"] ,
        ["3300.0", "3300.0"] ,
        ["3360.0", "3360.0"] ,
        ["3420.0", "3420.0"] ,
        ["3480.0", "3480.0"] ,
        ["3540.0", "3540.0"] ,
        ["3600.0", "3600.0"] ,
        ["3602.0", "3602.0"] ,
        ["3630.0", "3630.0"] ,
        ["3700.0", "3700.0"] ,
        ["3720.0", "3720.0"] ,
        ["3900.0", "3900.0"] ,
        ["4140.0", "4140.0"] ,
        ["4200.0", "4200.0"] ,
        ["4260.0", "4260.0"] ,
        ["4380.0", "4380.0"] ,
        ["4500.0", "4500.0"] ,
        ["4560.0", "4560.0"] ,
        ["4680.0", "4680.0"] ,
        ["4800.0", "4800.0"] ,
        ["4860.0", "4860.0"] ,
        ["5100.0", "5100.0"] ,
        ["5280.0", "5280.0"] ,
        ["5400.0", "5400.0"] ,
        ["5520.0", "5520.0"] ,
        ["5760.0", "5760.0"] ,
        ["6000.0", "6000.0"] ,
        ["6300.0", "6300.0"] ,
        ["6660.0", "6660.0"] ,
        ["6900.0", "6900.0"] ,
        ["7080.0", "7080.0"] ,
        ["7200.0", "7200.0"] ,
        ["7230.0", "7230.0"] ,
        ["7245.0", "7245.0"] ,
        ["7380.0", "7380.0"] ,
        ["7440.0", "7440.0"] ,
        ["7500.0", "7500.0"] ,
        ["7800.0", "7800.0"] ,
        ["8100.0", "8100.0"] ,
        ["8400.0", "8400.0"] ,
        ["8580.0", "8580.0"] ,
        ["8700.0", "8700.0"] ,
        ["9000.0", "9000.0"] ,
        ["9900.0", "9900.0"] ,
        ["10500.0", "10500.0"] ,
        ["10800.0", "10800.0"] ,
        ["11700.0", "11700.0"] ,
        ["12600.0", "12600.0"] ,
        ["13500.0", "13500.0"] ,
        ["14400.0", "14400.0"] ,
        ["15300.0", "15300.0"] ,
        ["15660.0", "15660.0"] ,
        ["16200.0", "16200.0"] ,
        ["18000.0", "18000.0"] ,
        ["18300.0", "18300.0"] ,
        ["19800.0", "19800.0"] ,
        ["21600.0", "21600.0"] ,
        ["23400.0", "23400.0"] ,
        ["25200.0", "25200.0"] ,
        ["28800.0", "28800.0"] ,
        ["30300.0", "30300.0"] ,
        ["32400.0", "32400.0"] ,
        ["36000.0", "36000.0"] ,
        ["37800.0", "37800.0"] ,
        ["39600.0", "39600.0"] ,
        ["42000.0", "42000.0"] ,
        ["43200.0", "43200.0"] ,
        ["46800.0", "46800.0"] ,
        ["50400.0", "50400.0"] ,
        ["54000.0", "54000.0"] ,
        ["56000.0", "56000.0"] ,
        ["57600.0", "57600.0"] ,
        ["60600.0", "60600.0"] ,
        ["64800.0", "64800.0"] ,
        ["72000.0", "72000.0"] ,
        ["73800.0", "73800.0"] ,
        ["86400.0", "86400.0"] ,
        ["108000.0", "108000.0"] ,
        ["109800.0", "109800.0"] ,
        ["145800.0", "145800.0"] ,
        ["172800.0", "172800.0"] ,
        ["219300.0", "219300.0"] ,
        ["253800.0", "253800.0"] ,
        ["259200.0", "259200.0"] ,
        ["345600.0", "345600.0"] ,
        ["361800.0", "361800.0"] ,
        ["432000.0", "432000.0"] ,
        ["604800.0", "604800.0"] ,
        ["777600.0", "777600.0"] ,
        ["1209600.0", "1209600.0"] ,
        ["1814400.0", "1814400.0"] ,
        ["2102400.0", "2102400.0"] ,
        ["2419200.0", "2419200.0"] ,
        ["2631600.0", "2631600.0"] ,
        ["6312000.0", "6312000.0"] ,
        ["7894800.0", "7894800.0"] ,
        ["10526400.0", "10526400.0"] ,
        ["52623200.0", "52623200.0"] ,
        ["66276000.0", "66276000.0"] 
    ]
}

var ufo_sightings_PROPERTIES = [
    ["Location.City", "Location.City"] ,
    ["Location.State", "Location.State"] ,
    ["Location.Country", "Location.Country"] ,
    ["Data.Shape", "Data.Shape"] ,
    ["Data.Encounter duration", "Data.Encounter duration"] ,
    ["Data.Description excerpt", "Data.Description excerpt"] ,
    ["Location.Coordinates.Latitude ", "Location.Coordinates.Latitude "] ,
    ["Location.Coordinates.Longitude ", "Location.Coordinates.Longitude "] ,
    ["Dates.Sighted.Year", "Dates.Sighted.Year"] ,
    ["Dates.Sighted.Month", "Dates.Sighted.Month"] ,
    ["Date.Sighted.Day", "Date.Sighted.Day"] ,
    ["Dates.Sighted.Hour", "Dates.Sighted.Hour"] ,
    ["Dates.Sighted.Minute", "Dates.Sighted.Minute"] ,
    ["Dates.Documented.Year", "Dates.Documented.Year"] ,
    ["Dates.Documented.Month", "Dates.Documented.Month"] ,
    ["Dates.Documented.Day", "Dates.Documented.Day"] 
]

Blockly.Blocks['ufo_sightings_get'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput('MAIN')
        .appendField("ufo_sightings.get")
        .appendField(new Blockly.FieldDropdown(ufo_sightings_PROPERTIES), "PROPERTY");
    this.appendDummyInput('SECOND')
        .appendField("filter")
        .appendField(new Blockly.FieldDropdown(ufo_sightings_INDEXES, function(option) {
                        this.getSourceBlock().updateShape_(option);
                    }), "INDEX")
    this.updateShape_("(None)");
    this.setInputsInline(false);
    this.setOutput(true, "Array");
    this.setTooltip('Returns a list of ufo sightings data.');
  },
  mutationToDom: function() {
    var container = document.createElement('mutation');
    container.setAttribute('index', this.getFieldValue('INDEX'));
    container.setAttribute('index_value', this.getFieldValue('INDEX_VALUE'));
    container.setAttribute('module', "ufo_sightings")
    return container;
  },
  domToMutation: function(xmlElement) {
    var index = xmlElement.getAttribute('index');
    this.setFieldValue(index, 'INDEX');
    var index_value = xmlElement.getAttribute('index_value');
    this.updateShape_(index, index_value);
  },
  updateShape_: function(index, index_value) {
    var inputGroup = this.getInput('SECOND')
    var fieldExists = this.getField('INDEX_VALUE');
    if (fieldExists) {
        inputGroup.removeField('INDEX_VALUE');
    }
    try {
        if (index != undefined && index != '(None)') {
            inputGroup.appendField(new Blockly.FieldDropdown(ufo_sightings_INDEX_VALUES[index]), 'INDEX_VALUE')
            if (index_value != undefined) {
                this.setFieldValue(index_value, 'INDEX_VALUE');
            } else {
                this.setFieldValue(ufo_sightings_INDEX_VALUES[index][0][0], 'INDEX_VALUE');
            }
        }
    } catch (e) {
        inputGroup.appendField(new Blockly.FieldLabel("Reset to fix the blocks"));
        console.error(e);
    }
  }
};
Blockly.Python['ufo_sightings_get'] = function(block) {
    Blockly.Python.definitions_['import_ufo_sightings'] = 'import ufo_sightings';
    var propertyValue = block.getFieldValue('PROPERTY') || '';
    var property = Blockly.Python.quote_(propertyValue);
    var index_unquoted = block.getFieldValue('INDEX');
    var index = Blockly.Python.quote_(index_unquoted || '');
    var index_value = "''";
    if (index_unquoted !== '(None)') {
        var iv = block.getFieldValue('INDEX_VALUE') || "";
        index_value = Blockly.Python.quote_(iv);
    }
    var code = 'ufo_sightings.get('+property+',' +index+','+index_value+')';
    return [code, Blockly.Python.ORDER_ATOMIC];
};

BlockMirrorTextToBlocks.prototype.MODULE_FUNCTION_SIGNATURES['ufo_sightings'] = {
    "get": {
        custom: function(node, parent) {
            if (!node.args || node.args.length < 3 ||
                !node.args[0] || !node.args[1] || !node.args[2] ||
                node.args[0]._astname !== "Str" || node.args[1]._astname !== "Str" || node.args[2]._astname !== "Str"
            ) {
                throw new Error("Not the right function call.");
            }
            return BlockMirrorTextToBlocks.create_block("ufo_sightings_get", null,
                {"PROPERTY": node.args[0].s.v},
                {}, {}, {"@INDEX": node.args[1].s.v,
                    "@INDEX_VALUE": node.args[2].s.v});
        }
    },
};

BlockMirrorBlockEditor.EXTRA_TOOLS['Data - ufo sightings'] = '<category name="Data - Ufo Sightings" colour="45">'+
                    '<block type="ufo_sightings_get"><mutation index="(None)" index_value=""></mutation></block>'+
                '</category>';